<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>READTalk ‚Äî Room</title>
<style>
/* === ANIMASI LOADING BARU === */
/* Loading Screen */
.loading {
    position: fixed;
    inset: 0;
    background: #ffffff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: opacity 1.5s ease-out;
    z-index: 1000;
}

.loading.fade-out {
    opacity: 0;
    pointer-events: none;
}

/* Logo */
.logo {
    width: 180px;
    height: auto;
    opacity: 0;
    animation: fadeInLogo 3s ease-in-out forwards;
    margin-bottom: 20px;
}

@keyframes fadeInLogo {
    0% { opacity: 0; transform: scale(0.8); }
    50% { opacity: 1; transform: scale(1.05); }
    100% { opacity: 1; transform: scale(1); }
}

/* Typewriter */
.typewriter {
    font-size: 18px;
    color: #000000;
    font-weight: bold;
    white-space: nowrap;
    overflow: visible;
    border-right: 2px solid #000000;
    margin-top: 10px;
    animation: blink 1s step-end infinite;
}

@keyframes blink {
    0%, 50%, 100% { border-color: transparent; }
    25%, 75% { border-color: #ff0000; }
}

.credit-loading {
    position: absolute;
    bottom: 50px;
    font-size: 14px;
    color: #aaaaaa;
}

/* === WHATSAPP PROPERTY PRESISI === */
:root {
    --whatsapp-bg: #f0f0f0;
    --whatsapp-header-bg: #ffffff;
    --whatsapp-card-bg: #ffffff;
    --whatsapp-text-primary: #000000;
    --whatsapp-text-secondary: #667781;
    --whatsapp-text-time: #667781;
    --whatsapp-border: #e0e0e0;
    --whatsapp-hover: #f5f5f5;
    --whatsapp-unread-bg: #e53935; /* READTalk red */
    --whatsapp-unread-text: #ffffff;
    --whatsapp-search-bg: #f6f6f6;
}

* { 
    box-sizing: border-box; 
    margin: 0; 
    padding: 0; 
    -webkit-tap-highlight-color: transparent;
}

body { 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    background: var(--whatsapp-bg); 
    height: 100vh;
    display: flex;
    flex-direction: column;
}

/* === HEADER WHATSAPP PRESISI === */
.header { 
    position: sticky; 
    top: 0; 
    background: var(--whatsapp-header-bg); 
    padding: 10px 16px 10px 12px; /* WhatsApp exact padding */
    border-bottom: 1px solid var(--whatsapp-border); 
    z-index: 10; 
    display: flex; 
    align-items: center; 
    justify-content: space-between;
    height: 60px; /* WhatsApp header height */
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.header h1 { 
    font-size: 20px; /* WhatsApp header font size */
    font-weight: 700; 
    color: var(--whatsapp-text-primary);
    flex: 1;
}

/* User info styling */
.user-info {
    display: flex;
    align-items: center;
    gap: 12px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #e53935, #ff6f61);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 16px;
    flex-shrink: 0;
}

.user-details {
    display: flex;
    flex-direction: column;
}

.user-name {
    font-size: 17px; /* WhatsApp contact name size */
    font-weight: 600;
    color: var(--whatsapp-text-primary);
    line-height: 1.2;
}

.user-username {
    font-size: 13px; /* WhatsApp status text size */
    color: var(--whatsapp-text-secondary);
    font-weight: 400;
}

/* Header actions */
.header-actions {
    display: flex;
    gap: 20px; /* WhatsApp icon spacing */
}

.header-btn {
    background: none;
    border: none;
    font-size: 20px; /* WhatsApp icon size */
    color: var(--whatsapp-text-primary);
    cursor: pointer;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
}

.header-btn:hover {
    background: var(--whatsapp-hover);
}

/* === SEARCH BAR WHATSAPP PRESISI === */
.search { 
    padding: 8px 12px; /* WhatsApp search padding */
    background: var(--whatsapp-header-bg);
    border-bottom: 1px solid var(--whatsapp-border);
}

.search-container {
    position: relative;
}

.search input { 
    width: 100%; 
    padding: 12px 16px 12px 44px; /* WhatsApp input padding with icon space */
    border-radius: 20px; /* WhatsApp search radius */
    border: 1px solid var(--whatsapp-border); 
    outline: none; 
    font-size: 15px; /* WhatsApp input font size */
    background: var(--whatsapp-search-bg);
    color: var(--whatsapp-text-primary);
    font-family: inherit;
}

.search input::placeholder {
    color: var(--whatsapp-text-secondary);
    font-weight: 400;
}

.search-icon {
    position: absolute;
    left: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--whatsapp-text-secondary);
    font-size: 18px;
    pointer-events: none;
}

/* === ROOM LIST CONTAINER === */
.room-list-container { 
    flex: 1; 
    overflow-y: auto; 
    padding-bottom: 20px; /* Space for FAB */
}

.room-list { 
    list-style: none; 
    background: var(--whatsapp-header-bg);
}

/* === ROOM ITEM WHATSAPP PRESISI === */
.room { 
    display: flex; 
    align-items: center; 
    padding: 12px 16px 12px 12px; /* WhatsApp room padding */
    gap: 12px; /* WhatsApp avatar-text gap */
    background: var(--whatsapp-card-bg); 
    cursor: pointer; 
    border-bottom: 1px solid var(--whatsapp-border); 
    position: relative;
    transition: background 0.2s;
    min-height: 80px; /* WhatsApp minimum room height */
}

.room:hover { 
    background: var(--whatsapp-hover); 
}

.room.active {
    background: #f0f8ff; /* Light selection color */
}

/* Avatar WhatsApp style */
.avatar { 
    width: 56px; /* WhatsApp avatar size */
    height: 56px; 
    border-radius: 50%; 
    background: linear-gradient(135deg, #e0e0e0, #f5f5f5);
    flex-shrink: 0; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-weight: 600; 
    color: #555; 
    overflow: hidden;
    position: relative;
}

.avatar img { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    border-radius: 50%; 
}

/* Online indicator */
.online-indicator {
    position: absolute;
    bottom: 2px;
    right: 2px;
    width: 12px;
    height: 12px;
    background: #4caf50; /* WhatsApp green */
    border: 2px solid white;
    border-radius: 50%;
}

.room-content { 
    flex: 1; 
    min-width: 0; 
    padding-right: 8px;
}

.room-top { 
    display: flex; 
    justify-content: space-between; 
    align-items: flex-start; 
    margin-bottom: 4px; /* WhatsApp spacing */
}

.room-name { 
    font-size: 16px; /* WhatsApp room name size */
    font-weight: 600; 
    color: var(--whatsapp-text-primary);
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis;
    flex: 1;
}

.room-time { 
    font-size: 12px; /* WhatsApp time stamp size */
    color: var(--whatsapp-text-time);
    flex-shrink: 0; 
    margin-left: 8px;
    font-weight: 400;
}

.room-preview { 
    font-size: 14px; /* WhatsApp preview text size */
    color: var(--whatsapp-text-secondary); 
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis;
    font-weight: 400;
    line-height: 1.4;
}

/* Unread badge WhatsApp style */
.badge { 
    background: var(--whatsapp-unread-bg); 
    color: var(--whatsapp-unread-text); 
    font-size: 12px; 
    font-weight: 600; 
    padding: 2px 6px; 
    border-radius: 10px; 
    position: absolute; 
    right: 16px; 
    top: 50%; 
    transform: translateY(-50%);
    min-width: 18px;
    height: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Room options (three dots) */
.options { 
    position: absolute; 
    right: 48px; /* Position next to badge */
    top: 50%; 
    transform: translateY(-50%); 
    cursor: pointer; 
    font-size: 18px; 
    color: var(--whatsapp-text-secondary);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
    opacity: 0;
}

.room:hover .options { 
    opacity: 1;
}

.options:hover {
    background: var(--whatsapp-hover);
}

/* Dropdown menu */
.dropdown { 
    position: absolute; 
    right: 16px; 
    top: 60px; 
    background: var(--whatsapp-card-bg); 
    border: 1px solid var(--whatsapp-border); 
    border-radius: 8px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.1); 
    display: none; 
    flex-direction: column; 
    min-width: 180px; 
    z-index: 20;
    overflow: hidden;
}

.dropdown button { 
    padding: 12px 16px; 
    border: none; 
    background: none; 
    text-align: left; 
    width: 100%; 
    cursor: pointer; 
    font-size: 14px; 
    color: var(--whatsapp-text-primary);
    transition: background 0.2s;
    display: flex;
    align-items: center;
    gap: 12px;
}

.dropdown button:hover { 
    background: var(--whatsapp-hover); 
}

.dropdown button i {
    font-size: 16px;
    width: 20px;
    text-align: center;
}

/* FAB (Floating Action Button) WhatsApp style */
.fab { 
    position: fixed; 
    right: 20px; 
    bottom: 20px; 
    width: 56px; /* WhatsApp FAB size */
    height: 56px; 
    border-radius: 50%; 
    background: #e53935; /* READTalk red */
    color: #fff; 
    border: none; 
    font-size: 28px; 
    line-height: 0; 
    cursor: pointer; 
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(229, 57, 53, 0.3);
    transition: transform 0.2s, box-shadow 0.2s;
    z-index: 10;
}

.fab:hover { 
    transform: scale(1.05); 
    box-shadow: 0 6px 16px rgba(229, 57, 53, 0.4);
}

/* Footer */
.footer { 
    text-align: center; 
    font-size: 11px; 
    color: var(--whatsapp-text-secondary); 
    padding: 16px; 
    flex-shrink: 0;
    background: var(--whatsapp-header-bg);
    border-top: 1px solid var(--whatsapp-border);
}

/* === SCROLLBAR WHATSAPP STYLE === */
.room-list-container::-webkit-scrollbar {
    width: 6px;
}

.room-list-container::-webkit-scrollbar-track {
    background: transparent;
}

.room-list-container::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 3px;
}

/* === EMPTY STATE === */
.empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 60px 20px;
    text-align: center;
    color: var(--whatsapp-text-secondary);
}

.empty-state-icon {
    font-size: 64px;
    margin-bottom: 16px;
    opacity: 0.5;
}

.empty-state-text {
    font-size: 16px;
    margin-bottom: 8px;
    color: var(--whatsapp-text-primary);
}

.empty-state-subtext {
    font-size: 14px;
    max-width: 300px;
    line-height: 1.4;
}

/* === ARCHIVED SECTION === */
.archived-header {
    padding: 16px 16px 8px;
    font-size: 14px;
    color: var(--whatsapp-text-secondary);
    background: var(--whatsapp-header-bg);
    border-bottom: 1px solid var(--whatsapp-border);
    font-weight: 500;
}

/* === ANIMATIONS === */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.room {
    animation: fadeIn 0.3s ease-out;
}
</style>
</head>
<body>

<!-- ===== ANIMASI LOADING BARU ===== -->
<div class="loading" id="loading">
    <img class="logo" src="logo.webp" alt="READTalk Logo">
    <div id="typewriter" class="typewriter"></div>
    <div class="credit-loading">
        ¬© 2025 SOEPARNO ENTERPRISE Corp.
    </div>
</div>

<!-- ===== APLIKASI UTAMA (DISEMBUNYIKAN AWALNYA) ===== -->
<div id="mainApp" style="display: none; height: 100%;">

<div class="header">
    <div class="user-info">
        <div class="user-avatar" id="userAvatar">JD</div>
        <div class="user-details">
            <div class="user-name" id="userName">John Doe</div>
            <div class="user-username" id="userUsername">@john</div>
        </div>
    </div>
    
    <div class="header-actions">
        <button class="header-btn" onclick="openCamera()" title="Camera">
            <span style="font-size: 22px;">üì∑</span>
        </button>
        <button class="header-btn" onclick="openNewChat()" title="New Chat">
            <span style="font-size: 22px;">‚úèÔ∏è</span>
        </button>
        <button class="header-btn" onclick="openSettings()" title="Settings">
            <span style="font-size: 22px;">‚ãÆ</span>
        </button>
    </div>
</div>

<div class="search">
    <div class="search-container">
        <div class="search-icon">üîç</div>
        <input type="text" id="searchInput" placeholder="Cari atau mulai chat baru..." />
    </div>
</div>

<div class="room-list-container" id="roomListContainer">
    <!-- Archived Chats Section -->
    <div class="archived-header" id="archivedHeader" style="display: none;">
        üîí Archived
    </div>
    
    <ul class="room-list" id="roomList">
        <!-- Rooms will be rendered here -->
    </ul>
    
    <!-- Empty State -->
    <div class="empty-state" id="emptyState" style="display: none;">
        <div class="empty-state-icon">üí¨</div>
        <div class="empty-state-text">No conversations yet</div>
        <div class="empty-state-subtext">Start a new conversation by tapping the + button</div>
    </div>
    
    <div class="footer">¬© 2025 SOEPARNO ENTERPRISE Corp. ‚Äî READTalk Messenger</div>
</div>

<button class="fab" title="Chat baru" onclick="createNewChat()">
    <span style="font-size: 28px; line-height: 0;">+</span>
</button>

</div> <!-- Penutup #mainApp -->

<script>
// ===== 1. ANIMASI LOADING =====
const text = "READTalk to Talk with Trust";
const typewriterEl = document.getElementById('typewriter');
let i = 0;
function typeWriter() {
    if (i < text.length) {
        typewriterEl.innerHTML += text.charAt(i);
        i++;
        setTimeout(typeWriter, 120);
    }
}

setTimeout(() => { typeWriter(); }, 1500);

setTimeout(() => {
    document.getElementById('loading').classList.add('fade-out');
    setTimeout(() => {
        document.getElementById('mainApp').style.display = 'flex';
    }, 800);
}, 5000);

// ===== 2. DATA STRUCTURE =====
function emailToUser(email){
    const [name] = email.split('@');
    const displayName = name.split('.').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' ');
    return { name: displayName, username: '@' + name, email: email };
}

const userEmail = localStorage.getItem('userEmail') || 'john.doe@example.com';
const user = emailToUser(userEmail);

document.getElementById('userAvatar').textContent = user.name.split(' ').map(n => n[0]).join('').substring(0, 2);
document.getElementById('userName').textContent = user.name;
document.getElementById('userUsername').textContent = user.username;

let rooms = [
    {
        id: 'self',
        name: user.name,
        username: user.username,
        avatar: '',
        last: 'Catatan pribadi üòä',
        time: 'Hari ini',
        unread: 0,
        online: true,
        archived: false,
        muted: false
    },
    {
        id: 'user_1',
        name: 'Red Business',
        username: '@red_biz',
        avatar: '',
        last: 'Hanya RED yang bisa mengirim pesan',
        time: 'Kemarin',
        unread: 0,
        online: true,
        archived: false,
        muted: true
    },
    {
        id: 'user_2',
        name: 'Bapak Qu',
        username: '@bapakqu',
        avatar: '',
        last: 'Telepon tak terjawab üòÖ',
        time: '11/12',
        unread: 2,
        online: false,
        archived: false,
        muted: false
    },
    {
        id: 'user_3',
        name: 'Cikal',
        username: '@cikal',
        avatar: '',
        last: 'Foto dikirim üì∏',
        time: '09/12',
        unread: 0,
        online: true,
        archived: true,
        muted: false
    },
    {
        id: 'user_4',
        name: 'Support Team',
        username: '@support',
        avatar: '',
        last: 'Terima kasih telah menghubungi kami',
        time: '08/12',
        unread: 1,
        online: false,
        archived: false,
        muted: false
    },
    {
        id: 'user_5',
        name: 'Development',
        username: '@dev',
        avatar: '',
        last: 'Meeting jam 14.00 WIB',
        time: '07/12',
        unread: 0,
        online: false,
        archived: false,
        muted: true
    }
];

function sortRooms() {
    const timeOrder = { 'Hari ini': 0, 'Kemarin': 1 };
    return rooms.sort((a, b) => {
        if (a.unread > 0 && b.unread === 0) return -1;
        if (a.unread === 0 && b.unread > 0) return 1;
        const timeA = timeOrder[a.time] !== undefined ? timeOrder[a.time] : 100;
        const timeB = timeOrder[b.time] !== undefined ? timeOrder[b.time] : 100;
        if (timeA !== timeB) return timeA - timeB;
        return a.name.localeCompare(b.name);
    });
}

const roomList = document.getElementById('roomList');
const roomListContainer = document.getElementById('roomListContainer');
const emptyState = document.getElementById('emptyState');
const archivedHeader = document.getElementById('archivedHeader');
const searchInput = document.getElementById('searchInput');

function renderRooms(filter = '') {
    const filteredRooms = rooms.filter(room => 
        room.name.toLowerCase().includes(filter.toLowerCase()) ||
        room.username.toLowerCase().includes(filter.toLowerCase()) ||
        room.last.toLowerCase().includes(filter.toLowerCase())
    );
    
    const activeRooms = filteredRooms.filter(room => !room.archived);
    const archivedRooms = filteredRooms.filter(room => room.archived);
    
    roomList.innerHTML = '';
    
    if (filteredRooms.length === 0) {
        emptyState.style.display = 'flex';
        archivedHeader.style.display = 'none';
        return;
    } else {
        emptyState.style.display = 'none';
    }
    
    activeRooms.forEach(room => {
        const li = createRoomElement(room);
        roomList.appendChild(li);
    });
    
    if (archivedRooms.length > 0) {
        archivedHeader.style.display = 'block';
        archivedRooms.forEach(room => {
            const li = createRoomElement(room);
            roomList.appendChild(li);
        });
    } else {
        archivedHeader.style.display = 'none';
    }
}

function createRoomElement(room) {
    const li = document.createElement('li');
    li.className = 'room' + (room.unread > 0 ? ' unread' : '');
    
    const avatarText = room.avatar || room.name.split(' ').map(n => n[0]).join('').substring(0, 2);
    
    const timeText = formatTime(room.time);
    
    li.innerHTML = `
        <div class="avatar">
            ${avatarText}
            ${room.online ? '<div class="online-indicator"></div>' : ''}
        </div>
        <div class="room-content">
            <div class="room-top">
                <div class="room-name">
                    ${room.name} 
                    <span style="font-weight:400;color:var(--whatsapp-text-secondary);">${room.username}</span>
                    ${room.muted ? ' <span style="font-size:12px;color:#888;">üîá</span>' : ''}
                </div>
                <div class="room-time">${timeText}</div>
            </div>
            <div class="room-preview">
                ${room.last}
            </div>
        </div>
        ${room.unread > 0 ? `<div class="badge">${room.unread}</div>` : ''}
        <div class="options" onclick="toggleDropdown(event, '${room.id}')">‚ãÆ</div>
        <div class="dropdown" id="dropdown-${room.id}">
            <button onclick="viewProfile(event, '${room.id}')">
                <span>üë§</span> View Profile
            </button>
            <button onclick="toggleMute(event, '${room.id}')">
                <span>${room.muted ? 'üîä' : 'üîá'}</span> ${room.muted ? 'Unmute' : 'Mute'}
            </button>
            <button onclick="archiveChat(event, '${room.id}')">
                <span>${room.archived ? 'üìÇ' : 'üìÅ'}</span> ${room.archived ? 'Unarchive' : 'Archive'}
            </button>
            <button onclick="deleteChat(event, '${room.id}')" style="color:#e53935;">
                <span>üóëÔ∏è</span> Delete Chat
            </button>
        </div>
    `;
    
    li.addEventListener('click', (e) => {
        if (!e.target.closest('.options') && !e.target.closest('.dropdown')) {
            window.location.href = 'chat.html?room=' + room.id;
        }
    });
    
    return li;
}

function formatTime(timeStr) {
    const today = new Date();
    const yesterday = new Date(today);
    yesterday.setDate(yesterday.getDate() - 1);
    
    if (timeStr === 'Hari ini') {
        return today.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
    } else if (timeStr === 'Kemarin') {
        return 'Kemarin';
    } else if (timeStr.includes('/')) {
        return timeStr;
    }
    return timeStr;
}

rooms = sortRooms();
renderRooms();

searchInput.addEventListener('input', (e) => {
    renderRooms(e.target.value);
});

searchInput.addEventListener('focus', () => {
    searchInput.parentElement.style.boxShadow = '0 0 0 2px rgba(229, 57, 53, 0.1)';
});

searchInput.addEventListener('blur', () => {
    searchInput.parentElement.style.boxShadow = 'none';
});

function toggleDropdown(event, roomId) {
    event.stopPropagation();
    
    document.querySelectorAll('.dropdown').forEach(dropdown => {
        if (dropdown.id !== `dropdown-${roomId}`) {
            dropdown.style.display = 'none';
        }
    });
    
    const dropdown = document.getElementById(`dropdown-${roomId}`);
    dropdown.style.display = dropdown.style.display === 'flex' ? 'none' : 'flex';
    
    const rect = dropdown.getBoundingClientRect();
    if (rect.bottom > window.innerHeight) {
        dropdown.style.top = `${rect.top - dropdown.offsetHeight - 10}px`;
    }
}

document.addEventListener('click', () => {
    document.querySelectorAll('.dropdown').forEach(dropdown => {
        dropdown.style.display = 'none';
    });
});

function viewProfile(event, roomId) {
    event.stopPropagation();
    const room = rooms.find(r => r.id === roomId);
    alert(`Profile: ${room.name}\nUsername: ${room.username}\nStatus: ${room.online ? 'Online' : 'Offline'}`);
    document.getElementById(`dropdown-${roomId}`).style.display = 'none';
}

function toggleMute(event, roomId) {
    event.stopPropagation();
    const room = rooms.find(r => r.id === roomId);
    room.muted = !room.muted;
    alert(`${room.name} ${room.muted ? 'dimute' : 'tidak dimute'}`);
    renderRooms(searchInput.value);
    document.getElementById(`dropdown-${roomId}`).style.display = 'none';
}

function archiveChat(event, roomId) {
    event.stopPropagation();
    const room = rooms.find(r => r.id === roomId);
    room.archived = !room.archived;
    alert(`Chat ${room.name} ${room.archived ? 'diarsipkan' : 'dipindahkan dari arsip'}`);
    rooms = sortRooms();
    renderRooms(searchInput.value);
    document.getElementById(`dropdown-${roomId}`).style.display = 'none';
}

function deleteChat(event, roomId) {
    event.stopPropagation();
    if (confirm('Hapus percakapan ini? Pesan akan dihapus dari perangkat ini.')) {
        rooms = rooms.filter(r => r.id !== roomId);
        renderRooms(searchInput.value);
    }
    document.getElementById(`dropdown-${roomId}`).style.display = 'none';
}

function openCamera() {
    alert('Kamera (dalam pengembangan)');
}

function openNewChat() {
    const newContact = prompt('Masukkan nama atau username kontak baru:');
    if (newContact && newContact.trim()) {
        const newId = 'new_' + Date.now();
        rooms.unshift({
            id: newId,
            name: newContact,
            username: '@new',
            avatar: '',
            last: 'Mulai percakapan baru',
            time: 'Hari ini',
            unread: 0,
            online: true,
            archived: false,
            muted: false
        });
        rooms = sortRooms();
        renderRooms(searchInput.value);
        alert(`Chat baru dengan ${newContact} dibuat`);
    }
}

function openSettings() {
    alert('Pengaturan (dalam pengembangan)');
}

function createNewChat() {
    openNewChat();
}

document.addEventListener('keydown', (e) => {
    if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        searchInput.focus();
    }
    
    if (e.key === 'Escape' && document.activeElement === searchInput) {
        searchInput.value = '';
        renderRooms('');
    }
});

setInterval(() => {
    rooms.forEach(room => {
        if (room.id !== 'self' && Math.random() > 0.7) {
            room.online = !room.online;
        }
    });
    
    document.querySelectorAll('.room').forEach((roomEl, index) => {
        const room = rooms[index];
        if (room) {
            const onlineIndicator = roomEl.querySelector('.online-indicator');
            if (onlineIndicator) {
                onlineIndicator.style.display = room.online ? 'block' : 'none';
            }
        }
    });
}, 30000);
</script>
</body>
</html>
