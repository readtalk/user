<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>READTalk ‚Äî Settings</title>
<style>
/* === WHATSAPP SETTINGS STYLE === */
:root {
    --whatsapp-bg: #f0f0f0;
    --whatsapp-card-bg: #ffffff;
    --whatsapp-text-primary: #000000;
    --whatsapp-text-secondary: #667781;
    --whatsapp-text-tertiary: #999999;
    --whatsapp-border: #e0e0e0;
    --whatsapp-hover: #f5f5f5;
    --whatsapp-accent: #e53935; /* READTalk red */
    --whatsapp-accent-hover: #d32f2f;
}

* { 
    box-sizing: border-box; 
    margin: 0; 
    padding: 0; 
    -webkit-tap-highlight-color: transparent;
}

body { 
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    background: var(--whatsapp-bg); 
    color: var(--whatsapp-text-primary);
    line-height: 1.4;
}

/* === HEADER === */
.settings-header {
    background: var(--whatsapp-card-bg);
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    border-bottom: 1px solid var(--whatsapp-border);
    position: sticky;
    top: 0;
    z-index: 10;
}

.back-btn {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--whatsapp-text-primary);
    cursor: pointer;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
}

.back-btn:hover {
    background: var(--whatsapp-hover);
}

.header-title {
    font-size: 20px;
    font-weight: 700;
    flex: 1;
}

/* === SETTINGS CONTAINER === */
.settings-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px 16px 100px;
}

/* === PROFILE SECTION === */
.profile-section {
    background: var(--whatsapp-card-bg);
    border-radius: 12px;
    margin-bottom: 20px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.section-header {
    padding: 20px 16px;
    border-bottom: 1px solid var(--whatsapp-border);
    font-size: 18px;
    font-weight: 600;
}

/* Profile Card */
.profile-card {
    padding: 20px 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    cursor: pointer;
    transition: background 0.2s;
}

.profile-card:hover {
    background: var(--whatsapp-hover);
}

.profile-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, #e53935, #ff6f61);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 32px;
    font-weight: 600;
    flex-shrink: 0;
    overflow: hidden;
    position: relative;
}

.profile-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
}

.profile-info {
    flex: 1;
    min-width: 0;
}

.profile-name {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 4px;
    color: var(--whatsapp-text-primary);
}

.profile-username {
    font-size: 14px;
    color: var(--whatsapp-text-secondary);
    margin-bottom: 6px;
}

.profile-status {
    font-size: 14px;
    color: var(--whatsapp-text-tertiary);
    font-style: italic;
}

/* === SETTINGS LIST === */
.settings-list {
    background: var(--whatsapp-card-bg);
    border-radius: 12px;
    margin-bottom: 20px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

.settings-item {
    display: flex;
    align-items: center;
    padding: 16px;
    border-bottom: 1px solid var(--whatsapp-border);
    cursor: pointer;
    transition: background 0.2s;
    text-decoration: none;
    color: inherit;
}

.settings-item:last-child {
    border-bottom: none;
}

.settings-item:hover {
    background: var(--whatsapp-hover);
}

.item-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--whatsapp-hover);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 16px;
    font-size: 20px;
    color: var(--whatsapp-text-primary);
    flex-shrink: 0;
}

.item-content {
    flex: 1;
    min-width: 0;
}

.item-title {
    font-size: 16px;
    font-weight: 500;
    margin-bottom: 2px;
    color: var(--whatsapp-text-primary);
}

.item-desc {
    font-size: 13px;
    color: var(--whatsapp-text-secondary);
}

.item-arrow {
    color: var(--whatsapp-text-tertiary);
    font-size: 18px;
    margin-left: 8px;
}

/* === PRIVACY SETTINGS === */
.privacy-options {
    padding: 16px;
}

.privacy-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid var(--whatsapp-border);
}

.privacy-item:last-child {
    border-bottom: none;
}

.privacy-label {
    flex: 1;
}

.privacy-title {
    font-size: 16px;
    font-weight: 500;
    margin-bottom: 2px;
    color: var(--whatsapp-text-primary);
}

.privacy-desc {
    font-size: 13px;
    color: var(--whatsapp-text-secondary);
}

.privacy-select {
    padding: 8px 12px;
    border: 1px solid var(--whatsapp-border);
    border-radius: 8px;
    background: var(--whatsapp-card-bg);
    color: var(--whatsapp-text-primary);
    font-size: 14px;
    min-width: 120px;
    cursor: pointer;
    outline: none;
}

.privacy-select:focus {
    border-color: var(--whatsapp-accent);
}

/* === SWITCH TOGGLE === */
.switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 28px;
}

.switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
}

.slider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .slider {
    background-color: var(--whatsapp-accent);
}

input:checked + .slider:before {
    transform: translateX(22px);
}

/* === ACTION BUTTONS === */
.action-buttons {
    padding: 20px 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.action-btn {
    padding: 14px 16px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.btn-primary {
    background: var(--whatsapp-accent);
    color: white;
}

.btn-primary:hover {
    background: var(--whatsapp-accent-hover);
}

.btn-secondary {
    background: var(--whatsapp-hover);
    color: var(--whatsapp-text-primary);
}

.btn-secondary:hover {
    background: #e0e0e0;
}

.btn-danger {
    background: #ffebee;
    color: #d32f2f;
}

.btn-danger:hover {
    background: #ffcdd2;
}

/* === MODALS === */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    padding: 20px;
}

.modal-content {
    background: var(--whatsapp-card-bg);
    border-radius: 12px;
    width: 100%;
    max-width: 500px;
    max-height: 80vh;
    overflow-y: auto;
    animation: modalSlideUp 0.3s ease;
}

@keyframes modalSlideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    padding: 20px;
    border-bottom: 1px solid var(--whatsapp-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.modal-title {
    font-size: 20px;
    font-weight: 600;
}

.modal-close {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--whatsapp-text-secondary);
    cursor: pointer;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: var(--whatsapp-hover);
}

.modal-body {
    padding: 20px;
}

/* Edit Profile Form */
.form-group {
    margin-bottom: 16px;
}

.form-label {
    display: block;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 6px;
    color: var(--whatsapp-text-primary);
}

.form-input {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--whatsapp-border);
    border-radius: 8px;
    font-size: 16px;
    background: var(--whatsapp-card-bg);
    color: var(--whatsapp-text-primary);
    outline: none;
}

.form-input:focus {
    border-color: var(--whatsapp-accent);
}

.form-textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--whatsapp-border);
    border-radius: 8px;
    font-size: 16px;
    background: var(--whatsapp-card-bg);
    color: var(--whatsapp-text-primary);
    outline: none;
    resize: vertical;
    min-height: 100px;
    font-family: inherit;
}

/* === FOOTER === */
.settings-footer {
    text-align: center;
    padding: 20px;
    font-size: 12px;
    color: var(--whatsapp-text-tertiary);
    border-top: 1px solid var(--whatsapp-border);
    margin-top: 20px;
}

/* === RESPONSIVE === */
@media (max-width: 600px) {
    .profile-card {
        padding: 16px;
    }
    
    .profile-avatar {
        width: 60px;
        height: 60px;
        font-size: 24px;
    }
    
    .settings-container {
        padding: 16px 12px 80px;
    }
}
</style>
</head>
<body>

<!-- HEADER -->
<header class="settings-header">
    <button class="back-btn" onclick="goBack()">‚Üê</button>
    <div class="header-title">Pengaturan</div>
</header>

<!-- SETTINGS CONTAINER -->
<main class="settings-container">
    
    <!-- PROFILE SECTION -->
    <section class="profile-section">
        <div class="section-header">Profil</div>
        <div class="profile-card" onclick="openEditProfile()">
            <div class="profile-avatar" id="profileAvatar">
                JD
            </div>
            <div class="profile-info">
                <div class="profile-name" id="profileName">John Doe</div>
                <div class="profile-username" id="profileUsername">@johndoe</div>
                <div class="profile-status" id="profileStatus">Available for chat</div>
            </div>
        </div>
    </section>
    
    <!-- PRIVACY SETTINGS -->
    <section class="settings-list">
        <div class="section-header">Privasi</div>
        
        <div class="privacy-options">
            <div class="privacy-item">
                <div class="privacy-label">
                    <div class="privacy-title">Foto Profil</div>
                    <div class="privacy-desc">Siapa yang bisa melihat foto profil Anda</div>
                </div>
                <select class="privacy-select" id="photoPrivacy">
                    <option value="everyone">Semua Orang</option>
                    <option value="contacts">Kontak Saya</option>
                    <option value="nobody">Tidak Ada</option>
                </select>
            </div>
            
            <div class="privacy-item">
                <div class="privacy-label">
                    <div class="privacy-title">Last Seen</div>
                    <div class="privacy-desc">Siapa yang bisa melihat kapan terakhir Anda online</div>
                </div>
                <select class="privacy-select" id="lastSeenPrivacy">
                    <option value="everyone">Semua Orang</option>
                    <option value="contacts">Kontak Saya</option>
                    <option value="nobody">Tidak Ada</option>
                </select>
            </div>
            
            <div class="privacy-item">
                <div class="privacy-label">
                    <div class="privacy-title">Status</div>
                    <div class="privacy-desc">Siapa yang bisa melihat status Anda</div>
                </div>
                <select class="privacy-select" id="statusPrivacy">
                    <option value="everyone">Semua Orang</option>
                    <option value="contacts">Kontak Saya</option>
                    <option value="nobody">Tidak Ada</option>
                </select>
            </div>
            
            <div class="privacy-item">
                <div class="privacy-label">
                    <div class="privacy-title">Grup</div>
                    <div class="privacy-desc">Siapa yang bisa menambahkan Anda ke grup</div>
                </div>
                <select class="privacy-select" id="groupPrivacy">
                    <option value="everyone">Semua Orang</option>
                    <option value="contacts">Kontak Saya</option>
                    <option value="contacts_except">Kontak Saya Kecuali...</option>
                </select>
            </div>
        </div>
    </section>
    
    <!-- NOTIFICATIONS -->
    <section class="settings-list">
        <div class="section-header">Notifikasi</div>
        
        <a class="settings-item" href="#">
            <div class="item-icon">üîî</div>
            <div class="item-content">
                <div class="item-title">Pesan & Grup</div>
                <div class="item-desc">Suara, popup, getaran</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
        
        <a class="settings-item" href="#">
            <div class="item-icon">üì¢</div>
            <div class="item-content">
                <div class="item-title">Suara & Getaran</div>
                <div class="item-desc">Setel nada dering dan getaran</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
        
        <div class="settings-item">
            <div class="item-icon">üîï</div>
            <div class="item-content">
                <div class="item-title">Senyap</div>
                <div class="item-desc">Nonaktifkan notifikasi</div>
            </div>
            <label class="switch">
                <input type="checkbox" id="muteNotifications">
                <span class="slider"></span>
            </label>
        </div>
    </section>
    
    <!-- ACCOUNT -->
    <section class="settings-list">
        <div class="section-header">Akun</div>
        
        <a class="settings-item" onclick="openSecurity()">
            <div class="item-icon">üîí</div>
            <div class="item-content">
                <div class="item-title">Keamanan</div>
                <div class="item-desc">Verifikasi dua langkah, kode keamanan</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
        
        <a class="settings-item" onclick="openPrivacyPolicy()">
            <div class="item-icon">üìÑ</div>
            <div class="item-content">
                <div class="item-title">Kebijakan Privasi</div>
                <div class="item-desc">Baca kebijakan privasi kami</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
        
        <a class="settings-item" onclick="openHelp()">
            <div class="item-icon">‚ùì</div>
            <div class="item-content">
                <div class="item-title">Bantuan</div>
                <div class="item-desc">Pusat bantuan dan FAQ</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
    </section>
    
    <!-- STORAGE -->
    <section class="settings-list">
        <div class="section-header">Penyimpanan & Data</div>
        
        <a class="settings-item" onclick="openStorage()">
            <div class="item-icon">üíæ</div>
            <div class="item-content">
                <div class="item-title">Penggunaan Penyimpanan</div>
                <div class="item-desc">1.2 GB digunakan</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
        
        <a class="settings-item" onclick="openNetwork()">
            <div class="item-icon">üì∂</div>
            <div class="item-content">
                <div class="item-title">Penggunaan Data</div>
                <div class="item-desc">Atur penggunaan data jaringan</div>
            </div>
            <div class="item-arrow">‚Ä∫</div>
        </a>
    </section>
    
    <!-- ACTIONS -->
    <section class="action-buttons">
        <button class="action-btn btn-primary" onclick="inviteFriends()">
            <span>üë•</span> Undang Teman
        </button>
        
        <button class="action-btn btn-secondary" onclick="exportData()">
            <span>üì§</span> Ekspor Data Chat
        </button>
        
        <button class="action-btn btn-danger" onclick="logout()">
            <span>üö™</span> Logout
        </button>
    </section>
    
    <!-- FOOTER -->
    <footer class="settings-footer">
        <div>READTalk v1.0.0</div>
        <div>¬© 2025 SOEPARNO ENTERPRISE Corp.</div>
    </footer>
</main>

<!-- EDIT PROFILE MODAL -->
<div class="modal-overlay" id="editProfileModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">Edit Profil</div>
            <button class="modal-close" onclick="closeEditProfile()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label class="form-label">Foto Profil</label>
                <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 16px;">
                    <div class="profile-avatar" id="modalAvatar" style="width: 80px; height: 80px; cursor: pointer;" onclick="changeProfilePhoto()">
                        JD
                    </div>
                    <div>
                        <button class="action-btn btn-secondary" onclick="changeProfilePhoto()" style="padding: 8px 12px; font-size: 14px;">
                            Ganti Foto
                        </button>
                        <div style="font-size: 12px; color: var(--whatsapp-text-tertiary); margin-top: 4px;">
                            Rekomendasi: 500x500px
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Nama</label>
                <input type="text" class="form-input" id="editName" placeholder="Nama Anda">
            </div>
            
            <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" class="form-input" id="editUsername" placeholder="@username">
            </div>
            
            <div class="form-group">
                <label class="form-label">Status (About)</label>
                <textarea class="form-textarea" id="editStatus" placeholder="Tentang saya..." maxlength="139"></textarea>
                <div style="text-align: right; font-size: 12px; color: var(--whatsapp-text-tertiary); margin-top: 4px;">
                    <span id="charCount">0</span>/139 karakter
                </div>
            </div>
            
            <button class="action-btn btn-primary" onclick="saveProfile()" style="width: 100%; margin-top: 20px;">
                Simpan Perubahan
            </button>
        </div>
    </div>
</div>

<!-- SECURITY MODAL -->
<div class="modal-overlay" id="securityModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">Keamanan</div>
            <button class="modal-close" onclick="closeSecurity()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="settings-item" onclick="openTwoStepVerification()">
                <div class="item-icon">üîê</div>
                <div class="item-content">
                    <div class="item-title">Verifikasi Dua Langkah</div>
                    <div class="item-desc">Tambahkan PIN untuk keamanan ekstra</div>
                </div>
                <div class="item-arrow">‚Ä∫</div>
            </div>
            
            <div class="settings-item" onclick="showSecurityCode()">
                <div class="item-icon">üî¢</div>
                <div class="item-content">
                    <div class="item-title">Kode Keamanan</div>
                    <div class="item-desc">Verifikasi enkripsi end-to-end</div>
                </div>
                <div class="item-arrow">‚Ä∫</div>
            </div>
            
            <div class="settings-item">
                <div class="item-icon">üì±</div>
                <div class="item-content">
                    <div class="item-title">Perangkat Tertaut</div>
                    <div class="item-desc">1 perangkat aktif</div>
                </div>
                <div class="item-arrow">‚Ä∫</div>
            </div>
            
            <div class="action-buttons" style="padding: 20px 0 0;">
                <button class="action-btn btn-secondary" onclick="changePassword()">
                    Ganti Password
                </button>
            </div>
        </div>
    </div>
</div>

<script>
// ===== DATA MANAGEMENT =====
// Load user data from localStorage (compatible with room.html & chat.html)
const userEmail = localStorage.getItem('userEmail') || 'john.doe@example.com';
let userProfile = JSON.parse(localStorage.getItem('readtalk_profile')) || {
    name: 'John Doe',
    username: '@johndoe',
    status: 'Available for chat',
    photoPrivacy: 'everyone',
    lastSeenPrivacy: 'everyone',
    statusPrivacy: 'everyone',
    groupPrivacy: 'everyone',
    muteNotifications: false
};

// Initialize UI
function initializeSettings() {
    // Profile section
    document.getElementById('profileName').textContent = userProfile.name;
    document.getElementById('profileUsername').textContent = userProfile.username;
    document.getElementById('profileStatus').textContent = userProfile.status;
    
    // Avatar initials
    const initials = userProfile.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
    document.getElementById('profileAvatar').textContent = initials;
    document.getElementById('modalAvatar').textContent = initials;
    
    // Privacy settings
    document.getElementById('photoPrivacy').value = userProfile.photoPrivacy;
    document.getElementById('lastSeenPrivacy').value = userProfile.lastSeenPrivacy;
    document.getElementById('statusPrivacy').value = userProfile.statusPrivacy;
    document.getElementById('groupPrivacy').value = userProfile.groupPrivacy;
    
    // Notifications
    document.getElementById('muteNotifications').checked = userProfile.muteNotifications;
    
    // Edit form
    document.getElementById('editName').value = userProfile.name;
    document.getElementById('editUsername').value = userProfile.username;
    document.getElementById('editStatus').value = userProfile.status;
    updateCharCount();
}

// ===== NAVIGATION =====
function goBack() {
    window.location.href = 'room.html';
}

// ===== MODAL FUNCTIONS =====
// Edit Profile Modal
function openEditProfile() {
    document.getElementById('editProfileModal').style.display = 'flex';
}

function closeEditProfile() {
    document.getElementById('editProfileModal').style.display = 'none';
}

// Security Modal
function openSecurity() {
    document.getElementById('securityModal').style.display = 'flex';
}

function closeSecurity() {
    document.getElementById('securityModal').style.display = 'none';
}

// ===== PROFILE FUNCTIONS =====
function changeProfilePhoto() {
    alert('Fitur ganti foto profil (dalam pengembangan)\n\nMock: Foto akan diupload ke server READTalk');
}

function updateCharCount() {
    const textarea = document.getElementById('editStatus');
    const charCount = document.getElementById('charCount');
    charCount.textContent = textarea.value.length;
    
    if (textarea.value.length > 139) {
        textarea.value = textarea.value.substring(0, 139);
        charCount.textContent = 139;
    }
}

document.getElementById('editStatus').addEventListener('input', updateCharCount);

function saveProfile() {
    const newName = document.getElementById('editName').value.trim();
    const newUsername = document.getElementById('editUsername').value.trim();
    const newStatus = document.getElementById('editStatus').value.trim();
    
    if (!newName) {
        alert('Nama tidak boleh kosong');
        return;
    }
    
    // Update profile
    userProfile.name = newName;
    userProfile.username = newUsername.startsWith('@') ? newUsername : '@' + newUsername;
    userProfile.status = newStatus || 'Available for chat';
    
    // Save to localStorage
    localStorage.setItem('readtalk_profile', JSON.stringify(userProfile));
    
    // Update UI
    initializeSettings();
    
    // Show success message
    alert('Profil berhasil diperbarui!');
    
    // Close modal
    closeEditProfile();
}

// ===== PRIVACY FUNCTIONS =====
// Auto-save privacy settings
document.querySelectorAll('.privacy-select').forEach(select => {
    select.addEventListener('change', function() {
        const setting = this.id;
        const value = this.value;
        
        // Update profile
        userProfile[setting] = value;
        localStorage.setItem('readtalk_profile', JSON.stringify(userProfile));
        
        // Show feedback
        showToast('Pengaturan privasi disimpan');
    });
});

// Toggle notifications
document.getElementById('muteNotifications').addEventListener('change', function() {
    userProfile.muteNotifications = this.checked;
    localStorage.setItem('readtalk_profile', JSON.stringify(userProfile));
    
    const status = this.checked ? 'dinonaktifkan' : 'diaktifkan';
    showToast(`Notifikasi ${status}`);
});

// ===== ACTION FUNCTIONS =====
function inviteFriends() {
    const shareText = `Ayo gunakan READTalk! Aplikasi chat yang cepat dan aman.\n\nDownload di: https://readtalk.github.io`;
    
    if (navigator.share) {
        navigator.share({
            title: 'READTalk Messenger',
            text: shareText,
            url: 'https://readtalk.github.io'
        });
    } else {
        navigator.clipboard.writeText(shareText).then(() => {
            alert('Tautan undangan telah disalin ke clipboard!');
        });
    }
}

function exportData() {
    const data = {
        profile: userProfile,
        exportDate: new Date().toISOString(),
        app: 'READTalk v1.0.0'
    };
    
    const dataStr = JSON.stringify(data, null, 2);
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
    
    const exportFileDefaultName = `readtalk-export-${new Date().getTime()}.json`;
    
    const linkElement = document.createElement('a');
    linkElement.setAttribute('href', dataUri);
    linkElement.setAttribute('download', exportFileDefaultName);
    linkElement.click();
    
    showToast('Data berhasil diekspor');
}

function logout() {
    if (confirm('Anda yakin ingin logout dari READTalk?')) {
        // Clear auth data (keep profile for next login)
        localStorage.removeItem('userEmail');
        
        // Redirect to login
        window.location.href = 'login.html';
    }
}

// ===== OTHER SETTINGS FUNCTIONS =====
function openPrivacyPolicy() {
    window.open('faq/privacy-policy.html', '_blank');
}

function openHelp() {
    alert('Pusat Bantuan READTalk\n\nEmail: support@readtalk.com\nWebsite: https://readtalk.github.io/help');
}

function openStorage() {
    alert('Penggunaan Penyimpanan:\n\n‚Ä¢ Pesan: 850 MB\n‚Ä¢ Foto: 300 MB\n‚Ä¢ Video: 50 MB\n‚Ä¢ Dokumen: 2 MB\n\nTotal: 1.2 GB');
}

function openNetwork() {
    alert('Penggunaan Data:\n\n‚Ä¢ Media auto-download: WiFi saja\n‚Ä¢ Kualitas panggilan: Otomatis\n‚Ä¢ Penggunaan bulanan: 150 MB');
}

function openTwoStepVerification() {
    alert('Verifikasi Dua Langkah:\n\nFitur ini akan meminta PIN setiap kali login dari perangkat baru.\n\n(Dalam pengembangan)');
}

function showSecurityCode() {
    const code = generateSecurityCode();
    alert(`Kode Keamanan Anda:\n\n${code}\n\nBagikan kode ini dengan kontak untuk verifikasi enkripsi end-to-end.`);
}

function generateSecurityCode() {
    // Generate a simple mock security code
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = '';
    for (let i = 0; i < 20; i++) {
        if (i > 0 && i % 5 === 0) code += ' ';
        code += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return code;
}

function changePassword() {
    const newPassword = prompt('Masukkan password baru:');
    if (newPassword && newPassword.length >= 6) {
        alert('Password berhasil diubah!');
    } else if (newPassword) {
        alert('Password minimal 6 karakter');
    }
}

// ===== UTILITY FUNCTIONS =====
function showToast(message) {
    // Create toast element
    const toast = document.createElement('div');
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--whatsapp-accent);
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        font-size: 14px;
        z-index: 1000;
        animation: fadeInOut 3s ease;
    `;
    
    // Add styles for animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateX(-50%) translateY(10px); }
            10% { opacity: 1; transform: translateX(-50%) translateY(0); }
            90% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(10px); }
        }
    `;
    document.head.appendChild(style);
    
    document.body.appendChild(toast);
    
    // Remove after animation
    setTimeout(() => {
        document.body.removeChild(toast);
        document.head.removeChild(style);
    }, 3000);
}

// ===== INITIALIZATION =====
document.addEventListener('DOMContentLoaded', initializeSettings);

// Close modals when clicking outside
document.querySelectorAll('.modal-overlay').forEach(modal => {
    modal.addEventListener('click', function(e) {
        if (e.target === this) {
            this.style.display = 'none';
        }
    });
});

// Keyboard shortcuts
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        document.querySelectorAll('.modal-overlay').forEach(modal => {
            modal.style.display = 'none';
        });
    }
});
</script>
</body>
</html>
